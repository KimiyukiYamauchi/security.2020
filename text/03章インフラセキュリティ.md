# 3章　インフラセキュリティ
## 3.1 TCP/IP 基礎
### 3.1.1 ネットワークモデル

OSI基本参照モデル | TCP／IPネットワークモデル | 代表的なプロトコル | ネットワーク機器 | アドレス
--- | --- | --- | --- | ---
アプリケーション層 | アプリケーション層 | HTTP, SMTP, FTP, SNMP, DNS, SNMP
プレゼンテーション層 | ↑ | ↑
セッション層 | ↑ | ↑
トランスポート層 | トランスポート層 | TCP, UDP |  | ポート番号
ネットワーク層 | インターネット層 | IP, ICMP, ARP | ルータ | IPアドレス
データリンク層 | ネットワーク・インタフェース層 | Ethernet, FDDI | スイッチングHUB | MACアドレス
物理層 | ↑ | ↑ | リピータHUB

### 3.1.2 階層化によるデータの流れ

- 上位層 -> 下位層
	- カプセル化、ヘッダの付加
- 下位層 -> 上位層
	- ヘッダ情報に基づいて、上位層へ

### 3.1.3  パケットのカプセル化

- 必要に応じて分割(フラグメント)
- 分割したデータにヘッダを付加
- ヘッダとペイロード

### 3.1.4 TCP/IP

TCP/IP(プロトコル)は通信での送信側と受信側での共通の規約、ルール、及びその実装を定義

```
葉書の宛名に例えると...

	住所 => IPアドレス
	氏名 => ポート番号

電話番号に例えると...

	外線番号 => グローバルアドレス
	内線番号 => プライベートアドレス
```

#### IPのバージョンごとの違い

##### IPv4
- 32ビット
- 約43億
- 10進数/4分割
- 暗号化 => 任意

##### IPv5
- 128ビット
- 42億 * 42億 * 42億 * 42億 => 約340澗個
- 16進数/8分割
- 暗号化 => 標準

#### IPアドレス

IPアドレスを用いてネットワーク上の端末(ノード)を識別

- IPv4の記述方法
	- 32ビット => 8ビットづつ4分割で10進数表記
	- 「.」で区切って表示
- IPv6の記述方法
	- 128ビット => 16ビットづつの16分割16進数表記
	- 「:」で区切って表示
	- 0は省略可能、すべて0のオクテット(区切り)は1箇所だけ「::」で省略可能

- グローバルアドレス
	- インターネット上でユニーク

- プライベートアドレス
	- LAN上でユニーク
	- 10.0.0.0 - 10.255.255.255
		- 0 => 00000000
		- 255 => 11111111
	- 172.16.0.0 - 172.31.255.255
		- 16 => 00010000
		- 31(16+15) => 00011111
		- 0000.00000000.00000000
		- 1111.11111111.11111111
	- 192.168.0.0 - 192.168.255.255

#### トランスポート層

ホスト上のどのサービスで処理するかを識別する

<dl>
<dt>TCP</dt>
<dd><ul>
<li>コネクション型</li>
<li>信頼性を自分自身で提供</li>
<li>オーバーヘッドが大きい</li>
<li>3wayハンドシェイク</li>
</ul></dd>
<dt>UDP</dt>
<dd><ul>
<li>コネクションレス型</li>
<li>上位層（アプリケーション層）に信頼性を提供させる</li>
<li>軽量</li>
<li>ブロードキャスト、マルチキャスト</li>
<li>DNS、DHCP、TFTP</li>
</ul></dd>
</dl>

プロコトル名 | 対応するポート番号 | 使用目的
--- | --- | ---
ftp | 20/tcp<br />21/tcp | ファイル転送
ssh | 22/tcp| セキュアなログイン(暗号化、認証機能あり、<br>セキュアなファイル転送(scp, sftpなど)<br />ポートフォワーディング機能
telnet | 23/tcp | リモートログイン
smtp | 25/tcp | 電子メール送信
http | 80/tcp | wwwサーバ閲覧
dhcp | 67/udp<br />68/udp | DHCPサーバ用<br />DHCPクライアント用
pop | 110/tcp | 電子メール受信
nntp | 119/tcp | ニュース送信
ntp | 123/udp | 時刻情報
imap | 143/tcp | 電子メール受信
snmp | 161/udp | ネットワーク経由での監視
https | 443/tcp | sslを使用した暗号化通信をするhttp

### 3.1.5 リピータ
* あるポートから受信したデータを電気的に増幅
* データはすべてのポートに送信 => 盗聴が可能

### 3.1.6 スイッチ
* 通信相手を特定しバイパスを作成
* データがネットワーク全体に流れない => 盗聴が不可
* ミラーポート

## 3.2 VPN
Vertual Private Network: 仮想私設通信網
暗号化などの技術を使用し、インタネットなどの公衆網等、安全でないネットワークにおいて<br />
安全な通信を行うために利用

### 3.2.1 VPNの構成要素
* トンネリング（カプセル化技術）
  * IP以外
  * プライベートアドレス
* 暗号化
* 認証
	- 相手先認証 => 相手が本物なのかを確認
	- メッセージ認証 => メッセージが改ざんされていないかの確認

## 3.3 無線LAN

- ケーブル敷設(ふせつ)の煩雑さがない、機動性
- 情報漏洩や不正アクセスの危険性

### 3.3.1 無線LANにおける脅威

* 通信内容の傍受（盗聴）
* 無線LANの不正利用
* アクセスポイントのなりすまし
* 公共の無線LAN(フリースポット)

### 3.3.2 無線LANのセキュリティ技術

* 基本機能
	* WEP => 暗号化
	* MACアドレスフィルタリング => 端末の接続制限
	* SSID => ネットワーク識別子
* TKIP => 暗号化、WEPの改善版
* CCMP(AES) => 暗号化、DESの後継
* IEEE802.1X => ユーザ認証

#### WPA/WPA2(Wi-Fi Aliance)

規格名 | 認証方式 | 暗号化方式
--- | --- | ---
WPA | IEEE802.1X | TKIP(RC4)/WEP(RC4)
WPA2 | IEEE802.1X | CCMP(AES)
WPA3 | IEEE802.1X | CCMP(AES/CNSA)

- IEEE802.11i
	- セキュリティに関する規格
	= 認証および暗号化はWPA2と同じ

無線LANセキュリティ運用

- アクセスポイントと無線ＬＡＮ端末間 => 上記
- エンド - エンド => TLS(SSL)など
- 通常時のインターネット利用と同様の対応
	- ファイアウォールの設定
	- セキュリティ対策ソフトのインストール